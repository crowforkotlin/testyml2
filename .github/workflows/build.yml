name: Build & Ship
on:
  push:
    branches:
      - main
permissions:
  contents: write
  pages: write          # <-- Add this line
  pull-requests: write  # To create a PR from that branch
jobs:
  push-to-another-repository:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout the origin
        uses: actions/checkout@v4
        with:
          fetch-depth: 0
      - name: Setup ssh for git command
        run: |
          mkdir -p ~/.ssh
          echo "${{ secrets.PAT_TOKEN }}" > ~/.ssh/id_rsa
          chmod 600 ~/.ssh/id_rsa
          export GIT_SSH_COMMAND="ssh -i ~/.ssh/id_rsa -o StrictHostKeyChecking=no"
      - name: Setup target remote
        run: |
          git remote add target "https://github.com/crowforkotlin/testyml1.git"
      - name: Creates commit and push
        run: |
          git config --global user.name 'github-actions'
          git config --global user.email 'github-actions@github.com'
          git add -A
          git commit -m "updates..."
          git push target dev
